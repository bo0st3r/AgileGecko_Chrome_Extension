<!--Error dialog-->
<p-dialog [(visible)]="coinsLoadingFailed" [closeOnEscape]="true"
          [dismissableMask]="true" [draggable]="false"
          [modal]="true" header="Coin list not found" styleClass="loading-error-dialog">
  We couldn't load the coins list, please check your Internet access or try later.
</p-dialog>

<!--Content-->
<div class="container-xs bg-gradient-main p-2">
  <div class="row justify-content-end pr-2 pt-1">
    <div class="col-2">
      <r-extension-hyperlink class="img-fluid pr-3" href="https://www.coingecko.com/" pTooltip="Open CoinGecko"
                             tooltipPosition="bottom">
        <img alt="CoinGecko logo" src="assets\img\coingecko_logo.svg" style="max-width:50px;"/>
      </r-extension-hyperlink>
    </div>
  </div>

  <div class="row mb-3 mt-3 justify-content-center">
    <!--    Search input-->
    <div class="col-9 justify-content-center p-inputgroup">
      <span class="p-inputgroup-addon"><i class="pi pi-search"></i></span>
      <input (keydown.enter)="tabManagerService.openTab(Url.COINGECKO_COIN_PREFIX + selectedCoin.id.toString())"
             (ngModelChange)="updateDisplayedCoins()" [(ngModel)]="searchedCoin" autocomplete="off"
             autofocus
             id="coin-searched" label="Name or symbol" pInputText
             placeholder="Name or symbol" type="text">
    </div>
  </div>

  <div class="row justify-content-center">
    <div class="col-12">
      <!--    Results-->
      <p-table [rows]="6" [scrollable]="true" [value]="displayedCoins"
               [virtualRowHeight]="6" [virtualScroll]="true" scrollHeight="286px" styleClass="p-datatable-striped">
        <ng-template pTemplate="header">
          <tr *ngIf="displayedCoins && displayedCoins.length > 0; then listSet else listUnset;"></tr>
          <ng-template #listSet>
            <tr>
              <th style="width:22.5%">Symbol</th>
              <th style="width:61.5%">Name</th>
              <th style="width:16%"></th>
            </tr>
          </ng-template>
          <ng-template #listUnset>
            <tr>
              <th>
                No coin were found
              </th>
            </tr>
          </ng-template>
        </ng-template>
        <ng-template let-coin pTemplate="body">
          <tr [pSelectableRow]="coin">
            <!--            Coin symbol-->
            <td style="width:22.5%">
              <p class="d-inline mr-2 font-weight-bold">{{coin.symbol | uppercase}}</p>
            </td>
            <!--            Coin name-->
            <td style="width:61.5%">
              <a (click)="tabManagerService.openTab(Url.COINGECKO_COIN_PREFIX + coin.id)"
                 class="mr-2 hyperlink" pTooltip="View on CG" tooltipPosition="bottom">{{coin.name}}</a>
            </td>
            <!--          ChartEx link & Favorite Icon -->
            <td class="text-center align-middle" style="width:16%">
              <i (click)="tabManagerService.openTab(Url.CHARTEX_PAIR_PREFIX + coin.symbol.toUpperCase())"
                 class="pi pi-chart-line mr-2 chart-icon" pTooltip="Chart" tooltipPosition="bottom"></i>
              <i (click)="favoriteManagerService.updateAndSaveFavorite(coin)"
                 [ngClass]="(favoriteCoinsContains(coin)) ? 'favorite-icon' : 'not-favorite-icon'"
                 class="pi pi-star font-weight-bold"
                 pTooltip="Favorite" tooltipPosition="bottom"></i>
            </td>
          </tr>
        </ng-template>
      </p-table>
    </div>
  </div>
</div>
